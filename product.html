<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body style="background: white;">
    <nav class="navbar">
        <a href="index.html"><i class="fas fa-arrow-left"></i></a>
        <div class="brand">Details</div>
        <a href="cart.html"><i class="fas fa-shopping-cart"></i><span id="cart-badge" class="badge">0</span></a>
    </nav>

    <div id="p-container" style="padding-bottom: 70px;">
        </div>

    <div class="bottom-nav">
        <button class="btn btn-outline" style="background:white; color:black">Add to Wishlist</button>
        <button id="add-btn" class="btn btn-secondary">ADD TO CART</button>
    </div>

    <div id="toast" class="toast"></div>

    <script type="module">
        import { loadProductDetails } from './js/products.js';
        import { addToCart, updateBadge } from './js/cart.js';
        import { formatPrice } from './js/ui.js';

        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        let currentProduct = null;

        async function init() {
            updateBadge();
            const p = await loadProductDetails(id);
            currentProduct = p;
            
            document.getElementById('p-container').innerHTML = `
                <img src="${p.image}" style="width:100%; height:300px; object-fit:contain; margin-top:20px;">
                <div style="padding:20px;">
                    <h2 style="font-size:1.1rem; margin-bottom:10px;">${p.name}</h2>
                    <h1 style="font-size:1.5rem;">${formatPrice(p.price)} <span class="p-mrp" style="font-size:1rem">${formatPrice(p.mrp)}</span></h1>
                    <p style="margin-top:15px; color:#555; line-height:1.5;">${p.description}</p>
                </div>
            `;
        }

        document.getElementById('add-btn').onclick = () => {
            if(currentProduct) addToCart(currentProduct);
        };
        init();
    </script>
</body>
</html>
